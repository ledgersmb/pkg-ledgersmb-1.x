debian/TODO for LedgerSMB ledgersmb-1.5 package

  - See also https://github.com/ledgersmb/pkg-ledgersmb-1.5/issues
  
================================================================================
--------------------------------------------------------------------------------
- Patch the SSL settings in the app proxy to use the 'snakeoil' certs by default
- Confirm which package installs that & add it to at least the Recommends?  I've
thought that it is ssl-cert.

--------------------------------------------------------------------------------
  - Implemented a work-around that halved (from 60 to 30) the number of the
source-is-missing Lintian errors in the ledgersmb pkg. Implmemt the same in
this pkg but not until the next version, which I expect to be 1.5.16, so that
only have to copy the UI/js/lsmb file to debian/missing-sources once (and not
again when the new version came out).

--------------------------------------------------------------------------------

- debian/ledgersmb.init
  There is a '--workers $WORKERS' parameter being used in the STARMAN cmd
line but that variable does not actually get set earlier in the script.  Be
interesting to see what David comes up with, as he was critiquing the init
in the ledgersmb (I think?), which has the same issue, but didn't comment on
it.  Refer back to the original script I adapted mine from?  Or wait for the
one to be made by David?
- See also: Provide a sysvinit init.d script for starman-ledgesmb
  https://github.com/ledgersmb/LedgerSMB/issues/2900


--------------------------------------------------------------------------------
  - debian/watch not working properly for gpg verification file
  - https://github.com/ledgersmb/pkg-ledgersmb-1.5/issues/3
Project has totally moved from SourceForge.net, so debian/watch needs to be
updated for the new locations of the distribution archive and its detached gpg
file for verification. An update for getting the distribution archive itself
appears to have been successful but the *.asc associated with it used for the
gpg verification does not seem to get refereneced properly so that step fails.
(So creating the orig archive needs to be done manually.) 

--------------------------------------------------------------------------------
  - There may be an issue with the debconf usage (besides the issue with the
  templates) during the pkg install.

- Note that there was an extranous "DO" showing up.  Possibly that was 
from debconf script that is not running properly, which it should because it's
defaulted to do so.  Maybe there's a problem with where it's supposed to be 
running in the maintainer script, as running dpkg-reconfigure on it runs
it with no apparant issue.  (Athought it also ended up displaying the extraneous
"DO" at the bottom left hand corner of the last debconf diaplay.)
 So perhaps there is an issue with the *.config file after all? Or is it indeed
 something to do with it the usage in the maintainer script.
 
-both the config script as well as where the debconf is used in the postintall
needs to be rewriten.
1) like the postinst;  when 'config' is called, $2 is the previous version if
there was one.
2) The $1 parameter is called with 'configure', or 'reconfigure' if called by
dpkg-reconfigure

-the debconf_install question is not needed any longer
-The dbadmin related questions only need to be asked if this is a new install
 and perhaps if it is a reconfigure?  Althought in that case, perhaps there
 should be question about if the password should be changed which defaults
 to "No"? (Altough then, would it need to be defaulted to 'Yes' and set to
 "No after it's been set or reset?)  But for by default the dbadmin user &
 its password should only be set in a new install, so that upgrades will not
 do it again. Perhaps only the reconfigure would have quiestion about resetting
 the password, with a default of no?   
 
-------------------------------------------------------------------------------
  - debian/adm/config-lsmb-db-user.sh

- Use only the postgresql tools, like createuser, to set the user name and 
password for the LSMB DB Admin user?  David G pointed out that using SQL
can allow the unencrypted password to perhaps show up in logs, etc, which
is a security concern.  So, use the sql to be able to tell if the user
is already present but use the standard tools to actually set it?  Or can
those be used unattended like is needed here?

- Take out defaulting to doing the SQL 'ALTER' instead of a 'CREATE'
if the LSMB DBAdmin user already exits? 
 Add option to reset the password if the
user ID already exists, but not by default? Would have to explicitly agree
to it, each time, and that agreement isn't saved so the question gets asked
each time and by default is not to do the reset?

  - see also: admin user password change (expected for v1.6)
https://github.com/ledgersmb/LedgerSMB/issues/2717

-------------------------------------------------------------------------------

  - Discussed in IRC some of the permission fix issues.  Erik took care of
  fixing many of them in both master & 1.5 so when the next release comes out
  will need to run a build of both ledgresmb & ledgersmb-1.5 without the 
  fixes enabled in order to check how the fix permissions stanza in d/rules
  can be updated for that.
  - Referance also https://github.com/ledgersmb/LedgerSMB/issues/2899 which is
  for the creation of a test in upstream that checks for such permission issues.

- As of the packageing for 1.5.13, this is what is in the override_dh_fixperms
  stanza
<-->dh_fixperms
<-->chmod +x debian/ledgersmb-1.5/usr/share/ledgersmb-1.5/sql/modules/reload_modules.sh
<-->chmod +x debian/ledgersmb-1.5/usr/share/ledgersmb-1.5/tools/dbsetup.pl
<-->chmod +x debian/ledgersmb-1.5/usr/share/ledgersmb-1.5/tools/drop-roles.pl
<-->chmod +x debian/ledgersmb-1.5/usr/share/ledgersmb-1.5/tools/install_interactive.pl
<-->chmod +x debian/ledgersmb-1.5/usr/share/ledgersmb-1.5/tools/pre-release-tests.sh
<-->chmod +x debian/ledgersmb-1.5/usr/share/ledgersmb-1.5/tools/starman.psgi
<-->chmod +x debian/ledgersmb-1.5/usr/share/ledgersmb-1.5/utils/notify_short/config.pl
<-->chmod +x debian/ledgersmb-1.5/usr/share/ledgersmb-1.5/utils/notify_short/listener.pl
<-->chmod +x debian/ledgersmb-1.5/usr/share/ledgersmb-1.5/utils/process_queue/config.pl.default
<-->chmod +x debian/ledgersmb-1.5/usr/share/ledgersmb-1.5/utils/process_queue/process_queue.pl
<-->chmod +x debian/ledgersmb-1.5/usr/share/ledgersmb-1.5/utils/replication/configure-replication.sh
<-->chmod -x debian/ledgersmb-1.5/usr/share/ledgersmb-1.5/locale/html/splash.html
<-->chmod -x debian/ledgersmb-1.5/usr/share/ledgersmb-1.5/lib/LedgerSMB/Template/TXT.pm
<-->chmod -x debian/ledgersmb-1.5/usr/share/ledgersmb-1.5/lib/LedgerSMB/Template/HTML.pm
<-->chmod -x debian/ledgersmb-1.5/usr/share/ledgersmb-1.5/lib/LedgerSMB/Template/CSV.pm
<-->chmod -x debian/ledgersmb-1.5/usr/share/ledgersmb-1.5/lib/LedgerSMB/Template/LaTeX.pm

---------------------------------------------------------------------------------------------------

https://github.com/ledgersmb/LedgerSMB/issues/2900
Although Debian (and others) do now use systemd by default, it does still
support sysvinit init.d scripts as well, so providing at least an example
init.d sysvinit startup script for starman-ledgersmb would be quite useful

- In the mean time, added an initial version of a possible script:
In order to test how that works, would have to use something that has been
changed to use sysv instead of systemd;  have been able to do some testing of
it but it's still not working properly so it needs more work.

-----------------------------------------------------------------------------------

- Currently have texlive-latex-recommended as a Recommends but that pulls a lot of
of other pkgs in and takes alot of space, and is only there regarding being able
to print to PDF.  Options for how to replace that at least for default printing
(some people will continue to use LaTex because they have dedicated resources
to it) have/are being generated, like modules or apps to print from html to pdf.
  Once that has been implemented, move the texlive requirement from Recommends to
Suggests and add some info about it to the README.Debian.

- Note that what has been discussed for an alternate default for printing has
been 'wkhtml2pdf'. See also:
https://github.com/ledgersmb/LedgerSMB/issues/2719

-------------------------------------------------------------------------------
  - lintian results from pkg build for 1.5.15-1~1 test build on 7 Jan 2018:

N: 345 tags overridden (341 errors, 2 warnings, 2 info)

I: ledgersmb-1.5 source: no-complete-debconf-translation

I: ledgersmb-1.5: systemd-service-file-missing-documentation-key lib/systemd/system/ledgersmb-1.5.service

I: ledgersmb-1.5: package-contains-empty-directory usr/share/ledgersmb-1.5/lib/LedgerSMB/Scripts/custom/
I: ledgersmb-1.5: unused-override package-contains-empty-directory usr/share/ledgersmb-1.5/lib/LedgerSMB/Scripts/custom

  - https://lintian.debian.org/tags/empty-binary-package.html
  - I have "dependency package" in their respective long descriptions but that
    doesn't seem to have helped, at least not when building under stretch.
W: ledgersmb-1.5-varnish: empty-binary-package
W: ledgersmb-1.5-nginx: empty-binary-package
W: ledgersmb-1.5-lighttpd: empty-binary-package

W: ledgersmb-1.5 changes: orig-tarball-missing-upstream-signature ledgersmb-1.5_1.5.15.orig.tar.gz

W: ledgersmb-1.5 source: out-of-date-standards-version 3.9.8 (current is 4.1.3)

I: ledgersmb-1.5 source: testsuite-autopkgtest-missing

  - Keeping this, as I do plan to use it later.
I: ledgersmb-1.5: unused-debconf-template ledgersmb-1.5/config_admin

-------------------------------------------------------------------------------
  - Interesting enough; this is available for Config::Model
https://metacpan.org/release/Config-Model-Systemd
  -> It's been in Debian since Stretch
  https://packages.debian.org/source/sid/libconfig-model-systemd-perl

  - So if there is a need to do a debconf update for the service file, will
  be able to do so?
- Being able to update the service file for the LSMB Starman port from the 
postinstall script may be quite useful. One could default to the standard port
but still be able to set it to run on a different port, which would allow multiple
lsmb installs of 1.5 or later. Investigate?

-----------------------------------------------------------------------------------
  - Use a separate source tarball for the UI/js/dojo and UI/js/dijit directories?
Devs have discussed it some but nothing has come of it as yet. If it's provided,
then a way to bypass all source-is-missing lintian errors on those directories
could be to use the multiple upstream tarballs functionality that's available
in the debian pkg format being used. 

https://wiki.debian.org/Projects/DebSrc3.0
https://raphaelhertzog.com/2010/09/07/how-to-use-multiple-upstream-tarballs-in-debian-source-packages/  

google search: debian package multiple source files

Note that this isn't necessary for the UI/js/lsmb directory because the source
for those are in the UI/js-src/lsmb directory. Although could perhaps investigate
where and how the lintian check looks for the source files to see if repacking
them where it looks for them would resolve this.

-----------------------------------------------------------------------------------

- Upstream uses pdflatex to create the distribution LedgerSMB-manual.pdf from
the source file doc/manual/LedgerSMB-manual.tex. Use the same source file to
create an HTML version? And to recreate the pdf version, to insure that it
is the from the current source file?

- Create an HTML and/or PDF file of templateing/templating-guide.tex? And
then register it with doc-base?
-----------------------------------------------------------------------------------

- A debian/po debconf Japanese translation has been provided. Currently,
there is no LSMB locale/po/ja.po file. Checked System|Lanaguage|List
Languages in LSMB 1.3.40: "ja" is not in the default list. It's also not
listed as an available language when editing templates, and presumably
those lists come from the same source. It can be added manually using
System|Language|Add Language. 


-----------------------------------------------------------------------------------

 -- Robert James Clay <jame@rocasa.us>  Tue,  9 Jan 2018 13:19 -0500
