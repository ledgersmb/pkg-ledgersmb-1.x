//>>built
define("dojo/Deferred",["./has","./_base/lang","./errors/CancelError","./promise/Promise","require"],function(e,r,n,t,i){"use strict";var s=0,u=1,f=2,o="This deferred has already been fulfilled.",c=Object.freeze||function(){},a=function(e,r,n,t,i){for(var s=0;s<e.length;s++)l(e[s],r,n,t)},l=function(e,r,n,t){var i=e[r],o=e.deferred;if(i)try{var c=i(n);if(r===s)"undefined"!=typeof c&&d(o,r,c);else{if(c&&"function"==typeof c.then)return e.cancel=c.cancel,void c.then(h(o,u),h(o,f),h(o,s));d(o,u,c)}}catch(a){d(o,f,a)}else d(o,r,n)},h=function(e,r){return function(n){d(e,r,n)}},d=function(e,r,n){if(!e.isCanceled())switch(r){case s:e.progress(n);break;case u:e.resolve(n);break;case f:e.reject(n)}},p=function(e){var r,i,h,d=this.promise=new t,v=this,g=!1,w=[];this.isResolved=d.isResolved=function(){return r===u},this.isRejected=d.isRejected=function(){return r===f},this.isFulfilled=d.isFulfilled=function(){return!!r},this.isCanceled=d.isCanceled=function(){return g},this.progress=function(e,n){if(r){if(n===!0)throw new Error(o);return d}return a(w,s,e,null,v),d},this.resolve=function(e,n){if(r){if(n===!0)throw new Error(o);return d}return a(w,r=u,i=e,null,v),w=null,d};var y=this.reject=function(e,n){if(r){if(n===!0)throw new Error(o);return d}return a(w,r=f,i=e,h,v),w=null,d};this.then=d.then=function(e,n,t){var s=[t,e,n];return s.cancel=d.cancel,s.deferred=new p(function(e){return s.cancel&&s.cancel(e)}),r&&!w?l(s,r,i,h):w.push(s),s.deferred.promise},this.cancel=d.cancel=function(t,s){if(r){if(s===!0)throw new Error(o)}else{if(e){var u=e(t);t="undefined"==typeof u?t:u}if(g=!0,!r)return"undefined"==typeof t&&(t=new n),y(t),t;if(r===f&&i===t)return t}},c(d)};return p.prototype.toString=function(){return"[object Deferred]"},i&&i(p),p});//# sourceMappingURL=Deferred.js.map