//>>built
define("dojo/back",["./_base/config","./_base/lang","./sniff","./dom","./dom-construct","./_base/window","require"],function(e,t,n,r,i,o,a){function s(){var e=k.pop();if(e){var t=k[k.length-1];t||0!=k.length||(t=y),t&&(t.kwArgs.back?t.kwArgs.back():t.kwArgs.backButton?t.kwArgs.backButton():t.kwArgs.handle&&t.kwArgs.handle("back")),C.push(e)}}function u(){var e=C.pop();e&&(e.kwArgs.forward?e.kwArgs.forward():e.kwArgs.forwardButton?e.kwArgs.forwardButton():e.kwArgs.handle&&e.kwArgs.handle("forward"),k.push(e))}function f(e,t,n){return{url:e,kwArgs:t,urlHash:n}}function l(e){var t=e.split("?");return t.length<2?null:t[1]}function d(){var t=(e.dojoIframeHistoryUrl||a.toUrl("./resources/iframe_history.html"))+"?"+(new Date).getTime();return A=!0,N&&(n("webkit")?N.location=t:window.frames[N.name].location=t),t}function c(){if(!x){var e=k.length,t=v();if((t===_||window.location.href==m)&&1==e)return void s();if(C.length>0&&C[C.length-1].urlHash===t)return void u();e>=2&&k[e-2]&&k[e-2].urlHash===t&&s()}}var h={};1&&t.setObject("dojo.back",h);var p,v=h.getHash=function(){var e=window.location.hash;return"#"==e.charAt(0)&&(e=e.substring(1)),n("mozilla")?e:decodeURIComponent(e)},g=h.setHash=function(e){e||(e=""),window.location.hash=encodeURIComponent(e),p=history.length},m="undefined"!=typeof window?window.location.href:"",_="undefined"!=typeof window?v():"",y=null,w=null,b=null,N=null,C=[],k=[],A=!1,x=!1;return h.goBack=s,h.goForward=u,h.init=function(){if(!r.byId("dj_history")){var t=e.dojoIframeHistoryUrl||a.toUrl("./resources/iframe_history.html");e.afterOnLoad?console.error("dojo/back::init() must be called before the DOM has loaded. Include dojo/back in a build layer."):document.write('<iframe style="border:0;width:1px;height:1px;position:absolute;visibility:hidden;bottom:0;right:0;" name="dj_history" id="dj_history" src="'+t+'"></iframe>')}},h.setInitialState=function(e){y=f(m,e,_)},h.addToHistory=function(t){C=[];var r=null,a=null;if(N||(e.useXDomain&&!e.dojoIframeHistoryUrl,N=window.frames.dj_history),b||(b=i.create("a",{style:{display:"none"}},o.body())),t.changeUrl){if(r=""+(t.changeUrl!==!0?t.changeUrl:(new Date).getTime()),0==k.length&&y.urlHash==r)return void(y=f(a,t,r));if(k.length>0&&k[k.length-1].urlHash==r)return void(k[k.length-1]=f(a,t,r));if(x=!0,setTimeout(function(){g(r),x=!1},1),b.href=r,n("ie")){a=d();var s=t.back||t.backButton||t.handle,u=function(e){""!=v()&&setTimeout(function(){g(r)},1),s.apply(this,[e])};t.back?t.back=u:t.backButton?t.backButton=u:t.handle&&(t.handle=u);var l=t.forward||t.forwardButton||t.handle,h=function(e){""!=v()&&g(r),l&&l.apply(this,[e])};t.forward?t.forward=h:t.forwardButton?t.forwardButton=h:t.handle&&(t.handle=h)}else n("ie")||w||(w=setInterval(c,200))}else a=d();k.push(f(a,t,r))},h._iframeLoaded=function(e,t){var n=l(t.href);return null==n?void(1==k.length&&s()):A?void(A=!1):void(k.length>=2&&n==l(k[k.length-2].url)?s():C.length>0&&n==l(C[C.length-1].url)&&u())},h});//# sourceMappingURL=back.js.map