//>>built
define("dijit/Menu",["require","dojo/_base/array","dojo/_base/declare","dojo/dom","dojo/dom-attr","dojo/dom-geometry","dojo/dom-style","dojo/keys","dojo/_base/lang","dojo/on","dojo/sniff","dojo/_base/window","dojo/window","./popup","./DropDownMenu","dojo/ready"],function(e,a,t,r,i,d,o,l,n,m,s,f,u,y,M,h){return s("dijit-legacy-requires")&&h(0,function(){var a=["dijit/MenuItem","dijit/PopupMenuItem","dijit/CheckedMenuItem","dijit/MenuSeparator"];e(a)}),t("dijit.Menu",M,{constructor:function(){this._bindings=[]},targetNodeIds:[],selector:"",contextMenuForWindow:!1,leftClickToOpen:!1,refocus:!0,postCreate:function(){this.contextMenuForWindow?this.bindDomNode(this.ownerDocumentBody):a.forEach(this.targetNodeIds,this.bindDomNode,this),this.inherited(arguments)},_iframeContentWindow:function(e){return u.get(this._iframeContentDocument(e))||this._iframeContentDocument(e).__parent__||e.name&&document.frames[e.name]||null},_iframeContentDocument:function(e){return e.contentDocument||e.contentWindow&&e.contentWindow.document||e.name&&document.frames[e.name]&&document.frames[e.name].document||null},bindDomNode:function(e){e=r.byId(e,this.ownerDocument);var a;if("iframe"==e.tagName.toLowerCase()){var t=e,d=this._iframeContentWindow(t);a=f.body(d.document)}else a=e==f.body(this.ownerDocument)?this.ownerDocument.documentElement:e;var o={node:e,iframe:t};i.set(e,"_dijitMenu"+this.id,this._bindings.push(o));var s=n.hitch(this,function(e){var a=this.selector,r=a?function(e){return m.selector(a,e)}:function(e){return e},i=this;return[m(e,r(this.leftClickToOpen?"click":"contextmenu"),function(e){e.stopPropagation(),e.preventDefault(),(new Date).getTime()<i._lastKeyDown+500||i._scheduleOpen(this,t,{x:e.pageX,y:e.pageY},e.target)}),m(e,r("keydown"),function(e){(93==e.keyCode||e.shiftKey&&e.keyCode==l.F10||i.leftClickToOpen&&e.keyCode==l.SPACE)&&(e.stopPropagation(),e.preventDefault(),i._scheduleOpen(this,t,null,e.target),i._lastKeyDown=(new Date).getTime())})]});o.connects=a?s(a):[],t&&(o.onloadHandler=n.hitch(this,function(){var e=this._iframeContentWindow(t),a=f.body(e.document);o.connects=s(a)}),t.addEventListener?t.addEventListener("load",o.onloadHandler,!1):t.attachEvent("onload",o.onloadHandler))},unBindDomNode:function(e){var a;try{a=r.byId(e,this.ownerDocument)}catch(t){return}var d="_dijitMenu"+this.id;if(a&&i.has(a,d)){for(var o,l=i.get(a,d)-1,n=this._bindings[l];o=n.connects.pop();)o.remove();var m=n.iframe;m&&(m.removeEventListener?m.removeEventListener("load",n.onloadHandler,!1):m.detachEvent("onload",n.onloadHandler)),i.remove(a,d),delete this._bindings[l]}},_scheduleOpen:function(e,a,t,r){this._openTimer||(this._openTimer=this.defer(function(){delete this._openTimer,this._openMyself({target:r,delegatedTarget:e,iframe:a,coords:t})},1))},_openMyself:function(e){function a(){g.refocus&&w&&w.focus(),y.close(g)}var t=e.target,i=e.iframe,l=e.coords,n=!l;if(this.currentTarget=e.delegatedTarget,l){if(i){var m=d.position(i,!0),f=this._iframeContentWindow(i),u=d.docScroll(f.document),M=o.getComputedStyle(i),h=o.toPixelValue,v=(s("ie")&&s("quirks")?0:h(i,M.paddingLeft))+(s("ie")&&s("quirks")?h(i,M.borderLeftWidth):0),c=(s("ie")&&s("quirks")?0:h(i,M.paddingTop))+(s("ie")&&s("quirks")?h(i,M.borderTopWidth):0);l.x+=m.x+v-u.x,l.y+=m.y+c-u.y}}else l=d.position(t,!0),l.x+=10,l.y+=10;var g=this,p=this._focusManager.get("prevNode"),b=this._focusManager.get("curNode"),w=!b||r.isDescendant(b,this.domNode)?p:b;y.open({popup:this,x:l.x,y:l.y,onExecute:a,onCancel:a,orient:this.isLeftToRight()?"L":"R"}),this.focus(),n||this.defer(function(){this._cleanUp(!0)}),this._onBlur=function(){this.inherited("_onBlur",arguments),y.close(this)}},destroy:function(){a.forEach(this._bindings,function(e){e&&this.unBindDomNode(e.node)},this),this.inherited(arguments)}})});//# sourceMappingURL=Menu.js.map