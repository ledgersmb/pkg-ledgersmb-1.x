//>>built
define("dijit/_editor/selection",["dojo/dom","dojo/_base/lang","dojo/sniff","dojo/_base/window","../main"],function(e,t,a,r,i){var d={getType:function(){if(r.doc.getSelection){var e,t="text";try{e=r.global.getSelection()}catch(a){}if(e&&1==e.rangeCount){var i=e.getRangeAt(0);i.startContainer==i.endContainer&&i.endOffset-i.startOffset==1&&3!=i.startContainer.nodeType&&(t="control")}return t}return r.doc.selection.type.toLowerCase()},getSelectedText:function(){if(r.doc.getSelection){var e=r.global.getSelection();return e?e.toString():""}return"control"==i._editor.selection.getType()?null:r.doc.selection.createRange().text},getSelectedHtml:function(){if(r.doc.getSelection){var e=r.global.getSelection();if(e&&e.rangeCount){var t,a="";for(t=0;t<e.rangeCount;t++){var d=e.getRangeAt(t).cloneContents(),o=r.doc.createElement("div");o.appendChild(d),a+=o.innerHTML}return a}return null}return"control"==i._editor.selection.getType()?null:r.doc.selection.createRange().htmlText},getSelectedElement:function(){if("control"==i._editor.selection.getType()){if(r.doc.getSelection){var e=r.global.getSelection();return e.anchorNode.childNodes[e.anchorOffset]}var t=r.doc.selection.createRange();if(t&&t.item)return r.doc.selection.createRange().item(0)}return null},getParentElement:function(){if("control"==i._editor.selection.getType()){var e=this.getSelectedElement();if(e)return e.parentNode}else{if(!r.doc.getSelection){var t=r.doc.selection.createRange();return t.collapse(!0),t.parentElement()}var a=r.global.getSelection();if(a){for(var d=a.anchorNode;d&&1!=d.nodeType;)d=d.parentNode;return d}}return null},hasAncestorElement:function(){return null!=this.getAncestorElement.apply(this,arguments)},getAncestorElement:function(){var e=this.getSelectedElement()||this.getParentElement();return this.getParentOfType(e,arguments)},isTag:function(e,t){if(e&&e.tagName)for(var a=e.tagName.toLowerCase(),r=0;r<t.length;r++){var i=String(t[r]).toLowerCase();if(a==i)return i}return""},getParentOfType:function(e,t){for(;e;){if(this.isTag(e,t).length)return e;e=e.parentNode}return null},collapse:function(e){if(r.doc.getSelection){var t=r.global.getSelection();t.removeAllRanges?e?t.collapseToStart():t.collapseToEnd():t.collapse(e)}else{var a=r.doc.selection.createRange();a.collapse(e),a.select()}},remove:function(){var e=r.doc.selection;return r.doc.getSelection?(e=r.global.getSelection(),e.deleteFromDocument(),e):("none"!=e.type.toLowerCase()&&e.clear(),e)},selectElementChildren:function(t,i){var d,o=r.doc;if(t=e.byId(t),r.doc.getSelection){var n=r.global.getSelection();a("opera")?(d=n.rangeCount?n.getRangeAt(0):o.createRange(),d.setStart(t,0),d.setEnd(t,3==t.nodeType?t.length:t.childNodes.length),n.addRange(d)):n.selectAllChildren(t)}else if(d=t.ownerDocument.body.createTextRange(),d.moveToElementText(t),!i)try{d.select()}catch(l){}},selectElement:function(t,i){var d;t=e.byId(t);var o=t.ownerDocument,n=r.global;if(o.getSelection){var l=n.getSelection();d=o.createRange(),l.removeAllRanges&&(a("opera")&&l.getRangeAt(0)&&(d=l.getRangeAt(0)),d.selectNode(t),l.removeAllRanges(),l.addRange(d))}else try{var s=t.tagName?t.tagName.toLowerCase():"";d="img"===s||"table"===s?r.body(o).createControlRange():r.body(o).createRange(),d.addElement(t),i||d.select()}catch(m){this.selectElementChildren(t,i)}},inSelection:function(e){if(e){var t,a,i=r.doc;if(r.doc.getSelection){var d=r.global.getSelection();if(d&&d.rangeCount>0&&(a=d.getRangeAt(0)),a&&a.compareBoundaryPoints&&i.createRange)try{if(t=i.createRange(),t.setStart(e,0),1===a.compareBoundaryPoints(a.START_TO_END,t))return!0}catch(o){}}else{a=i.selection.createRange();try{t=e.ownerDocument.body.createControlRange(),t&&t.addElement(e)}catch(n){try{t=e.ownerDocument.body.createTextRange(),t.moveToElementText(e)}catch(l){}}if(a&&t&&1===a.compareEndPoints("EndToStart",t))return!0}}return!1}};return t.setObject("dijit._editor.selection",d),d});//# sourceMappingURL=selection.js.map