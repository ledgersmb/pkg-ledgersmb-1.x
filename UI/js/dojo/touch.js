//>>built
define("dojo/touch",["./_base/kernel","./aspect","./dom","./dom-class","./_base/lang","./on","./has","./mouse","./domReady","./_base/window"],function(e,t,n,r,o,i,a,s,u,c){function d(e,t,n){return C&&n?function(e,t){return i(e,n,t)}:T?function(n,r){var o=i(n,t,function(e){r.call(this,e),w=(new Date).getTime()}),a=i(n,e,function(e){(!w||(new Date).getTime()>w+1e3)&&r.call(this,e)});return{remove:function(){o.remove(),a.remove()}}}:function(t,n){return i(t,e,n)}}function l(e){do if(void 0!==e.dojoClick)return e;while(e=e.parentNode)}function f(e,t,o){function a(e){p=E?n.isDescendant(c.doc.elementFromPoint(e.changedTouches?e.changedTouches[0].pageX-c.global.pageXOffset:e.clientX,e.changedTouches?e.changedTouches[0].pageY-c.global.pageYOffset:e.clientY),g):p&&(e.changedTouches?e.changedTouches[0].target:e.target)==g&&Math.abs((e.changedTouches?e.changedTouches[0].pageX-c.global.pageXOffset:e.clientX)-m)<=y&&Math.abs((e.changedTouches?e.changedTouches[0].pageY-c.global.pageYOffset:e.clientY)-v)<=b}function u(e){c.doc.addEventListener(e,function(t){var n=t.target;p&&!t._dojo_click&&(new Date).getTime()<=_+1e3&&("INPUT"!=n.tagName||!r.contains(n,"dijitOffScreen"))&&(t.stopPropagation(),t.stopImmediatePropagation&&t.stopImmediatePropagation(),"click"==e&&("INPUT"!=n.tagName||"radio"==n.type&&(r.contains(n,"dijitCheckBoxInput")||r.contains(n,"mblRadioButton"))||"checkbox"==n.type&&(r.contains(n,"dijitCheckBoxInput")||r.contains(n,"mblCheckBox")))&&"TEXTAREA"!=n.tagName&&"AUDIO"!=n.tagName&&"VIDEO"!=n.tagName&&t.preventDefault())},!0)}if(!s.isRight(e)){var d=l(e.target);p=!e.target.disabled&&d&&d.dojoClick,p&&(E="useTarget"==p,g=E?d:e.target,E&&e.preventDefault(),m=e.changedTouches?e.changedTouches[0].pageX-c.global.pageXOffset:e.clientX,v=e.changedTouches?e.changedTouches[0].pageY-c.global.pageYOffset:e.clientY,y=("object"==typeof p?p.x:"number"==typeof p?p:0)||4,b=("object"==typeof p?p.y:"number"==typeof p?p:0)||4,h||(h=!0,c.doc.addEventListener(t,function(e){s.isRight(e)||(a(e),E&&e.preventDefault())},!0),c.doc.addEventListener(o,function(e){function t(t){var n=document.createEvent("MouseEvents");return n._dojo_click=!0,n.initMouseEvent(t,!0,!0,e.view,e.detail,o.screenX,o.screenY,o.clientX,o.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,0,null),n}if(!s.isRight(e)&&(a(e),p)){_=(new Date).getTime();var r=E?g:e.target;"LABEL"===r.tagName&&(r=n.byId(r.getAttribute("for"))||r);var o=e.changedTouches?e.changedTouches[0]:e,u=t("mousedown"),c=t("mouseup"),d=t("click");setTimeout(function(){i.emit(r,"mousedown",u),i.emit(r,"mouseup",c),i.emit(r,"click",d),_=(new Date).getTime()},0)}},!0),u("click"),u("mousedown"),u("mouseup")))}}var h,p,g,m,v,y,b,_,w,x,j=a("ios")<5,C=a("pointer-events")||a("MSPointer"),N=function(){var e={};for(var t in{down:1,move:1,up:1,cancel:1,over:1,out:1})e[t]=a("MSPointer")?"MSPointer"+t.charAt(0).toUpperCase()+t.slice(1):"pointer"+t;return e}(),T=a("touch-events"),E=!1;a("touch")&&u(C?function(){c.doc.addEventListener(N.down,function(e){f(e,N.move,N.up)},!0)}:function(){function e(e){var t=o.delegate(e,{bubbles:!0});return a("ios")>=6&&(t.touches=e.touches,t.altKey=e.altKey,t.changedTouches=e.changedTouches,t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.shiftKey=e.shiftKey,t.targetTouches=e.targetTouches),t}x=c.body(),c.doc.addEventListener("touchstart",function(e){w=(new Date).getTime();var t=x;x=e.target,i.emit(t,"dojotouchout",{relatedTarget:x,bubbles:!0}),i.emit(x,"dojotouchover",{relatedTarget:t,bubbles:!0}),f(e,"touchmove","touchend")},!0),i(c.doc,"touchmove",function(t){w=(new Date).getTime();var n=c.doc.elementFromPoint(t.pageX-(j?0:c.global.pageXOffset),t.pageY-(j?0:c.global.pageYOffset));n&&(x!==n&&(i.emit(x,"dojotouchout",{relatedTarget:n,bubbles:!0}),i.emit(n,"dojotouchover",{relatedTarget:x,bubbles:!0}),x=n),i.emit(n,"dojotouchmove",e(t))||t.preventDefault())}),i(c.doc,"touchend",function(t){w=(new Date).getTime();var n=c.doc.elementFromPoint(t.pageX-(j?0:c.global.pageXOffset),t.pageY-(j?0:c.global.pageYOffset))||c.body();i.emit(n,"dojotouchend",e(t))})});var k={press:d("mousedown","touchstart",N.down),move:d("mousemove","dojotouchmove",N.move),release:d("mouseup","dojotouchend",N.up),cancel:d(s.leave,"touchcancel",C?N.cancel:null),over:d("mouseover","dojotouchover",N.over),out:d("mouseout","dojotouchout",N.out),enter:s._eventHandler(d("mouseover","dojotouchover",N.over)),leave:s._eventHandler(d("mouseout","dojotouchout",N.out))};return 1&&(e.touch=k),k});//# sourceMappingURL=touch.js.map