//>>built
define("dojo/_base/fx",["./kernel","./config","./lang","../Evented","./Color","../aspect","../sniff","../dom","../dom-style"],function(e,t,n,r,o,i,a,s,c){var u=n.mixin,d={},l=d._Line=function(e,t){this.start=e,this.end=t};l.prototype.getValue=function(e){return(this.end-this.start)*e+this.start};var f=d.Animation=function(e){u(this,e),n.isArray(this.curve)&&(this.curve=new l(this.curve[0],this.curve[1]))};f.prototype=new r,n.extend(f,{duration:350,repeat:0,rate:20,_percent:0,_startRepeatCount:0,_getStep:function(){var e=this._percent,t=this.easing;return t?t(e):e},_fire:function(e,n){var r=n||[];if(this[e])if(t.debugAtAllCosts)this[e].apply(this,r);else try{this[e].apply(this,r)}catch(o){console.error("exception in animation handler for:",e),console.error(o)}return this},play:function(e,t){var r=this;if(r._delayTimer&&r._clearTimer(),t)r._stopTimer(),r._active=r._paused=!1,r._percent=0;else if(r._active&&!r._paused)return r;r._fire("beforeBegin",[r.node]);var o=e||r.delay,i=n.hitch(r,"_play",t);return o>0?(r._delayTimer=setTimeout(i,o),r):(i(),r)},_play:function(){var e=this;e._delayTimer&&e._clearTimer(),e._startTime=(new Date).valueOf(),e._paused&&(e._startTime-=e.duration*e._percent),e._active=!0,e._paused=!1;var t=e.curve.getValue(e._getStep());return e._percent||(e._startRepeatCount||(e._startRepeatCount=e.repeat),e._fire("onBegin",[t])),e._fire("onPlay",[t]),e._cycle(),e},pause:function(){var e=this;return e._delayTimer&&e._clearTimer(),e._stopTimer(),e._active?(e._paused=!0,e._fire("onPause",[e.curve.getValue(e._getStep())]),e):e},gotoPercent:function(e,t){var n=this;return n._stopTimer(),n._active=n._paused=!0,n._percent=e,t&&n.play(),n},stop:function(e){var t=this;return t._delayTimer&&t._clearTimer(),t._timer?(t._stopTimer(),e&&(t._percent=1),t._fire("onStop",[t.curve.getValue(t._getStep())]),t._active=t._paused=!1,t):t},destroy:function(){this.stop()},status:function(){return this._active?this._paused?"paused":"playing":"stopped"},_cycle:function(){var e=this;if(e._active){var t=(new Date).valueOf(),n=0===e.duration?1:(t-e._startTime)/e.duration;n>=1&&(n=1),e._percent=n,e.easing&&(n=e.easing(n)),e._fire("onAnimate",[e.curve.getValue(n)]),e._percent<1?e._startTimer():(e._active=!1,e.repeat>0?(e.repeat--,e.play(null,!0)):-1==e.repeat?e.play(null,!0):e._startRepeatCount&&(e.repeat=e._startRepeatCount,e._startRepeatCount=0),e._percent=0,e._fire("onEnd",[e.node]),!e.repeat&&e._stopTimer())}return e},_clearTimer:function(){clearTimeout(this._delayTimer),delete this._delayTimer}});var h=0,p=null,g={run:function(){}};n.extend(f,{_startTimer:function(){this._timer||(this._timer=i.after(g,"run",n.hitch(this,"_cycle"),!0),h++),p||(p=setInterval(n.hitch(g,"run"),this.rate))},_stopTimer:function(){this._timer&&(this._timer.remove(),this._timer=null,h--),0>=h&&(clearInterval(p),p=null,h=0)}});var m=a("ie")?function(e){var t=e.style;t.width.length||"auto"!=c.get(e,"width")||(t.width="auto")}:function(){};d._fade=function(e){e.node=s.byId(e.node);var t=u({properties:{}},e),r=t.properties.opacity={};r.start="start"in t?t.start:function(){return+c.get(t.node,"opacity")||0},r.end=t.end;var o=d.animateProperty(t);return i.after(o,"beforeBegin",n.partial(m,t.node),!0),o},d.fadeIn=function(e){return d._fade(u({end:1},e))},d.fadeOut=function(e){return d._fade(u({end:0},e))},d._defaultEasing=function(e){return.5+Math.sin((e+1.5)*Math.PI)/2};var v=function(e){this._properties=e;for(var t in e){var n=e[t];n.start instanceof o&&(n.tempColor=new o)}};return v.prototype.getValue=function(e){var t={};for(var r in this._properties){var i=this._properties[r],a=i.start;a instanceof o?t[r]=o.blendColors(a,i.end,e,i.tempColor).toCss():n.isArray(a)||(t[r]=(i.end-a)*e+a+("opacity"!=r?i.units||"px":0))}return t},d.animateProperty=function(t){var r=t.node=s.byId(t.node);t.easing||(t.easing=e._defaultEasing);var a=new f(t);return i.after(a,"beforeBegin",n.hitch(a,function(){function e(e,t){var n={height:e.offsetHeight,width:e.offsetWidth}[t];return void 0!==n?n:(n=c.get(e,t),"opacity"==t?+n:s?n:parseFloat(n))}var t={};for(var i in this.properties){("width"==i||"height"==i)&&(this.node.display="block");var a=this.properties[i];n.isFunction(a)&&(a=a(r)),a=t[i]=u({},n.isObject(a)?a:{end:a}),n.isFunction(a.start)&&(a.start=a.start(r)),n.isFunction(a.end)&&(a.end=a.end(r));var s=i.toLowerCase().indexOf("color")>=0;"end"in a?"start"in a||(a.start=e(r,i)):a.end=e(r,i),s?(a.start=new o(a.start),a.end=new o(a.end)):a.start="opacity"==i?+a.start:parseFloat(a.start)}this.curve=new v(t)}),!0),i.after(a,"onAnimate",n.hitch(c,"set",a.node),!0),a},d.anim=function(e,t,n,r,o,i){return d.animateProperty({node:e,duration:n||f.prototype.duration,properties:t,easing:r,onEnd:o}).play(i||0)},u(e,d),e._Animation=f,d});//# sourceMappingURL=fx.js.map