//>>built
define("dijit/_base/focus",["dojo/_base/array","dojo/dom","dojo/_base/lang","dojo/topic","dojo/_base/window","../focus","../selection","../main"],function(e,t,a,r,i,d,o,n){var l={_curFocus:null,_prevFocus:null,isCollapsed:function(){return n.getBookmark().isCollapsed},getBookmark:function(){var e=i.global==window?o:new o.SelectionManager(i.global);return e.getBookmark()},moveToBookmark:function(e){var t=i.global==window?o:new o.SelectionManager(i.global);return t.moveToBookmark(e)},getFocus:function(e,a){var r=!d.curNode||e&&t.isDescendant(d.curNode,e.domNode)?n._prevFocus:d.curNode;return{node:r,bookmark:r&&r==d.curNode&&i.withGlobal(a||i.global,n.getBookmark),openedForWindow:a}},_activeStack:[],registerIframe:function(e){return d.registerIframe(e)},unregisterIframe:function(e){e&&e.remove()},registerWin:function(e,t){return d.registerWin(e,t)},unregisterWin:function(e){e&&e.remove()}};return d.focus=function(e){if(e){var t="node"in e?e.node:e,a=e.bookmark,r=e.openedForWindow,o=a?a.isCollapsed:!1;if(t){var l="iframe"==t.tagName.toLowerCase()?t.contentWindow:t;if(l&&l.focus)try{l.focus()}catch(s){}d._onFocusNode(t)}if(a&&i.withGlobal(r||i.global,n.isCollapsed)&&!o){r&&r.focus();try{i.withGlobal(r||i.global,n.moveToBookmark,null,[a])}catch(m){}}}},d.watch("curNode",function(e,t,a){n._curFocus=a,n._prevFocus=t,a&&r.publish("focusNode",a)}),d.watch("activeStack",function(e,t,a){n._activeStack=a}),d.on("widget-blur",function(e,t){r.publish("widgetBlur",e,t)}),d.on("widget-focus",function(e,t){r.publish("widgetFocus",e,t)}),a.mixin(n,l),n});//# sourceMappingURL=focus.js.map