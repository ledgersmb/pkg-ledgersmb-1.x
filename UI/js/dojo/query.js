//>>built
define("dojo/query",["./_base/kernel","./has","./dom","./on","./_base/array","./_base/lang","./selector/_loader","./selector/_loader!default"],function(e,t,n,r,o,i,a,s){"use strict";function u(e,t){var r=function(r,o){if("string"==typeof o&&(o=n.byId(o),!o))return new t([]);var i="string"==typeof r?e(r,o):r?r.end&&r.on?r:[r]:[];return i.end&&i.on?i:new t(i)};if(r.matches=e.match||function(e,t,n){return r.filter([e],t,n).length>0},r.filter=e.filter||function(e,t,n){return r(t,n).filter(function(t){return o.indexOf(e,t)>-1})},"function"!=typeof e){var i=e.search;e=function(e,t){return i(t||document,e)}}return r}t.add("array-extensible",function(){return 1==i.delegate([],{length:1}).length&&!t("bug-for-in-skips-shadowed")});var c=Array.prototype,d=c.slice,l=c.concat,f=o.forEach,h=function(e,t,n){var r=new(n||this._NodeListCtor||_)(e);return t?r._stash(t):r},p=function(t,n,r){return n=[0].concat(d.call(n,0)),r=r||e.global,function(e){return n[0]=e,t.apply(r,n)}},g=function(e,t){return function(){return this.forEach(p(e,arguments,t)),this}},m=function(e,t){return function(){return this.map(p(e,arguments,t))}},v=function(e,t){return function(){return this.filter(p(e,arguments,t))}},y=function(t,n,r){return function(){var o=arguments,i=p(t,o,r);return n.call(r||e.global,o)?this.map(i):(this.forEach(i),this)}},b=function(e){var n=this instanceof _&&t("array-extensible");"number"==typeof e&&(e=Array(e));var r=e&&"length"in e?e:arguments;if(n||!r.sort){for(var o=n?this:[],a=o.length=r.length,s=0;a>s;s++)o[s]=r[s];if(n)return o;r=o}return i._mixin(r,w),r._NodeListCtor=function(e){return _(e)},r},_=b,w=_.prototype=t("array-extensible")?[]:{};_._wrap=w._wrap=h,_._adaptAsMap=m,_._adaptAsForEach=g,_._adaptAsFilter=v,_._adaptWithCondition=y,f(["slice","splice"],function(e){var t=c[e];w[e]=function(){return this._wrap(t.apply(this,arguments),"slice"==e?this:null)}}),f(["indexOf","lastIndexOf","every","some"],function(t){var n=o[t];w[t]=function(){return n.apply(e,[this].concat(d.call(arguments,0)))}}),i.extend(b,{constructor:_,_NodeListCtor:_,toString:function(){return this.join(",")},_stash:function(e){return this._parent=e,this},on:function(e,t){var n=this.map(function(n){return r(n,e,t)});return n.remove=function(){for(var e=0;e<n.length;e++)n[e].remove()},n},end:function(){return this._parent?this._parent:new this._NodeListCtor(0)},concat:function(){var e=d.call(this,0),t=o.map(arguments,function(e){return d.call(e,0)});return this._wrap(l.apply(e,t),this)},map:function(e,t){return this._wrap(o.map(this,e,t),this)},forEach:function(e,t){return f(this,e,t),this},filter:function(e){var t=arguments,n=this,r=0;if("string"==typeof e){if(n=x._filterResult(this,t[0]),1==t.length)return n._stash(this);r=1}return this._wrap(o.filter(n,t[r],t[r+1]),this)},instantiate:function(e,t){var n=i.isFunction(e)?e:i.getObject(e);return t=t||{},this.forEach(function(e){new n(t,e)})},at:function(){var e=new this._NodeListCtor(0);return f(arguments,function(t){0>t&&(t=this.length+t),this[t]&&e.push(this[t])},this),e._stash(this)}});var x=u(s,b);return e.query=u(s,function(e){return b(e)}),x.load=function(e,t,n){a.load(e,t,function(e){n(u(e,b))})},e._filterQueryResult=x._filterResult=function(e,t,n){return new b(x.filter(e,t,n))},e.NodeList=x.NodeList=b,x});//# sourceMappingURL=query.js.map