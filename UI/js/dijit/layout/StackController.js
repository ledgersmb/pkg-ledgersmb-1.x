//>>built
define("dijit/layout/StackController",["dojo/_base/array","dojo/_base/declare","dojo/dom-class","dojo/dom-construct","dojo/keys","dojo/_base/lang","dojo/on","dojo/topic","../focus","../registry","../_Widget","../_TemplatedMixin","../_Container","../form/ToggleButton","dojo/touch"],function(e,t,a,i,r,d,o,n,l,s,m,u,f,h){var y=t("dijit.layout._StackButton",h,{tabIndex:"-1",closeButton:!1,_aria_attr:"aria-selected",buildRendering:function(){this.inherited(arguments),(this.focusNode||this.domNode).setAttribute("role","tab")}}),c=t("dijit.layout.StackController",[m,u,f],{baseClass:"dijitStackController",templateString:"<span role='tablist' data-dojo-attach-event='onkeydown'></span>",containerId:"",buttonWidget:y,buttonWidgetCloseClass:"dijitStackCloseButton",pane2button:function(e){return s.byId(this.id+"_"+e)},postCreate:function(){this.inherited(arguments),this.own(n.subscribe(this.containerId+"-startup",d.hitch(this,"onStartup")),n.subscribe(this.containerId+"-addChild",d.hitch(this,"onAddChild")),n.subscribe(this.containerId+"-removeChild",d.hitch(this,"onRemoveChild")),n.subscribe(this.containerId+"-selectChild",d.hitch(this,"onSelectChild")),n.subscribe(this.containerId+"-containerKeyDown",d.hitch(this,"onContainerKeyDown"))),this.containerNode.dojoClick=!0,this.own(o(this.containerNode,"click",d.hitch(this,function(e){var t=s.getEnclosingWidget(e.target);if(t!=this.containerNode&&!t.disabled&&t.page)for(var i=e.target;i!==this.containerNode;i=i.parentNode){if(a.contains(i,this.buttonWidgetCloseClass)){this.onCloseButtonClick(t.page);break}if(i==t.domNode){this.onButtonClick(t.page);break}}})))},onStartup:function(t){this.textDir=t.textDir,e.forEach(t.children,this.onAddChild,this),t.selected&&this.onSelectChild(t.selected);var a=s.byId(this.containerId).containerNode,i=d.hitch(this,"pane2button"),r={title:"label",showtitle:"showLabel",iconclass:"iconClass",closable:"closeButton",tooltip:"title",disabled:"disabled",textdir:"textdir"},n=function(e,t){return o(a,"attrmodified-"+e,function(e){var a=i(e.detail&&e.detail.widget&&e.detail.widget.id);a&&a.set(t,e.detail.newValue)})};for(var l in r)this.own(n(l,r[l]))},destroy:function(e){this.destroyDescendants(e),this.inherited(arguments)},onAddChild:function(e,t){var a=d.isString(this.buttonWidget)?d.getObject(this.buttonWidget):this.buttonWidget,i=new a({id:this.id+"_"+e.id,name:this.id+"_"+e.id,label:e.title,disabled:e.disabled,ownerDocument:this.ownerDocument,dir:e.dir,lang:e.lang,textDir:e.textDir||this.textDir,showLabel:e.showTitle,iconClass:e.iconClass,closeButton:e.closable,title:e.tooltip,page:e});this.addChild(i,t),e.controlButton=i,this._currentChild||this.onSelectChild(e);var r=e._wrapper.getAttribute("aria-labelledby")?e._wrapper.getAttribute("aria-labelledby")+" "+i.id:i.id;e._wrapper.removeAttribute("aria-label"),e._wrapper.setAttribute("aria-labelledby",r)},onRemoveChild:function(e){this._currentChild===e&&(this._currentChild=null);var t=this.pane2button(e.id);t&&(this.removeChild(t),t.destroy()),delete e.controlButton},onSelectChild:function(e){if(e){if(this._currentChild){var t=this.pane2button(this._currentChild.id);t.set("checked",!1),t.focusNode.setAttribute("tabIndex","-1")}var a=this.pane2button(e.id);a.set("checked",!0),this._currentChild=e,a.focusNode.setAttribute("tabIndex","0");{s.byId(this.containerId)}}},onButtonClick:function(e){var t=this.pane2button(e.id);l.focus(t.focusNode),this._currentChild&&this._currentChild.id===e.id&&t.set("checked",!0);var a=s.byId(this.containerId);a.selectChild(e)},onCloseButtonClick:function(e){var t=s.byId(this.containerId);if(t.closeChild(e),this._currentChild){var a=this.pane2button(this._currentChild.id);a&&l.focus(a.focusNode||a.domNode)}},adjacent:function(t){this.isLeftToRight()||this.tabPosition&&!/top|bottom/.test(this.tabPosition)||(t=!t);var a,i=this.getChildren(),r=e.indexOf(i,this.pane2button(this._currentChild.id)),d=i[r];do r=(r+(t?1:i.length-1))%i.length,a=i[r];while(a.disabled&&a!=d);return a},onkeydown:function(e){if(!this.disabled&&!e.altKey){var t=null;if(e.ctrlKey||!e._djpage){switch(e.keyCode){case r.LEFT_ARROW:case r.UP_ARROW:e._djpage||(t=!1);break;case r.PAGE_UP:e.ctrlKey&&(t=!1);break;case r.RIGHT_ARROW:case r.DOWN_ARROW:e._djpage||(t=!0);break;case r.PAGE_DOWN:e.ctrlKey&&(t=!0);break;case r.HOME:for(var a=this.getChildren(),i=0;i<a.length;i++){var d=a[i];if(!d.disabled){this.onButtonClick(d.page);break}}e.stopPropagation(),e.preventDefault();break;case r.END:for(var a=this.getChildren(),i=a.length-1;i>=0;i--){var d=a[i];if(!d.disabled){this.onButtonClick(d.page);break}}e.stopPropagation(),e.preventDefault();break;case r.DELETE:case"W".charCodeAt(0):this._currentChild.closable&&(e.keyCode==r.DELETE||e.ctrlKey)&&(this.onCloseButtonClick(this._currentChild),e.stopPropagation(),e.preventDefault());break;case r.TAB:e.ctrlKey&&(this.onButtonClick(this.adjacent(!e.shiftKey).page),e.stopPropagation(),e.preventDefault())}null!==t&&(this.onButtonClick(this.adjacent(t).page),e.stopPropagation(),e.preventDefault())}}},onContainerKeyDown:function(e){e.e._djpage=e.page,this.onkeydown(e.e)}});return c.StackButton=y,c});//# sourceMappingURL=StackController.js.map